<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Hong Kong English RPG Quiz</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    html, body {font-family: "Segoe UI", Arial, sans-serif; margin: 0; padding: 0; background: #212145; min-height: 100vh; color: #fafafa;}
    #game-container {max-width: 520px; margin: 0 auto; padding: 2em 1em 3em 1em; background: rgba(35, 34, 60, 0.95); border-radius: 16px; margin-top: 2em; box-shadow: 0 2px 16px rgba(0,0,0,0.3);}
    .stats {display: flex; justify-content: space-between; margin-bottom: 1em;}
    .bar {height: 18px; border-radius: 9px; background: #fff2; margin-bottom: 4px; overflow: hidden; margin-top: 3px;}
    .bar-inner {height: 100%; border-radius: 9px;}
    .bar-player {background: linear-gradient(90deg,#70f570,#49c628);}
    .bar-npc {background: linear-gradient(90deg,#f85032,#e73827);}
    h2 {margin-top: 0.4em; margin-bottom: 0.5em; font-size: 1.3em;}
    .question {margin: 1.2em 0; font-size: 1.1em; line-height: 1.5;}
    .answers {margin-bottom: 1.2em;}
    .answers button {background: #39397a; color: #fafafa; border: none; padding: 0.6em 1.2em; margin: 0.3em 0.3em 0.3em 0; border-radius: 7px; font-size: 1em; transition: background 0.2s; cursor: pointer; box-shadow: 0 2px 8px #0002; min-width: 120px;}
    .answers button:focus {outline: 2px solid #FFD700;}
    .answers button:hover, .answers .correct {background: #38ef7d; color: #30305a;}
    .answers .wrong {background: #f85032; color: #fff;}
    #log {border-top: 1px solid #fff2; padding-top: 1em; margin-top: 1em; font-size: 0.97em; color: #ffffcc; min-height: 2em;} /* Improved contrast for accessibility */
    #score-panel {margin-bottom: 1em; text-align: center; font-size: 1.12em; color: #f1e16a; font-weight: 600;}
    #story {background: #39397a; border-radius: 7px; padding: 0.8em 1em; margin-bottom: 1.2em; font-size: 1.05em; color: #fdfbdf; min-height: 2.2em;}
    .enemy-img {font-size: 2.3em; margin-bottom: 0.2em; display: inline-block; vertical-align: middle; transition: transform 0.2s;} /* Animation for hit feedback */
    .enemy-hit {transform: translateX(-5px);} /* Animation class for hit */
    .inventory {margin: 0.6em 0 0.3em 0; display: flex; flex-wrap: wrap; gap: 8px; min-height: 2.2em; overflow-x: auto;} /* Scrollable on small screens for responsive design */
    .inv-btn {background: #f3f3aa; color: #2a2a2a; border-radius: 5px; padding: 0.25em 0.7em; font-size: 0.95em; margin-right: 0.2em; margin-bottom: 0.2em; display: flex; align-items: center; gap: 4px; cursor: pointer; border: none; transition: filter 0.2s; box-shadow: 0 2px 6px #0002;}
    .inv-btn:disabled {background: #b6b6a9; color: #5a5a5a; filter: grayscale(0.6); cursor: default;}
    .inventory-empty {color: #b6b6a9; font-style: italic;} /* Placeholder for empty inventory */
    .progress-bar-bg {width: 100%; height: 12px; background: #2c2c3e; border-radius: 7px; margin: 7px 0 13px 0; overflow: hidden;}
    .progress-bar {height: 100%; background: linear-gradient(90deg,#FFD700,#38ef7d 70%); border-radius: 7px; transition: width 0.4s;}
    #glossary-btn, #hint-btn, #save-exit-btn, #tutorial-btn, #stats-btn, #audio-toggle-btn {background: #70f570; color: #222; font-size: 1.0em; padding: 0.5em 1.3em; border: none; border-radius: 7px; cursor: pointer; margin: 0.4em 0.2em 0.4em 0; box-shadow: 0 2px 8px #0002; display: inline-block; min-width: 110px;}
    #hint-btn[disabled] {background: #b6e2bc; color: #5a5a5a; cursor: default;}
    #glossary-modal, #tutorial-modal, #stats-modal, #confirm-modal {position: fixed; top:0; left:0; width:100vw; height:100vh; background: rgba(0,0,0,0.66); z-index: 1000; display: none; align-items: center; justify-content: center;}
    .modal-content {background: #22224A; color: #fdfbdf; padding: 2em 1.2em; border-radius: 14px; max-width: 350px; text-align: center; position: relative; box-shadow: 0 2px 16px #0007;}
    .modal-content button {background: #FFD700; color: #24243e; font-weight: 600; border-radius: 8px; padding: 0.4em 1.5em; margin-top: 1em; border: none; font-size: 1.06em; cursor: pointer;}
    .glossary-term {font-weight: bold; color: #FFD700;}
    .glossary-pron {font-style: italic; color: #a0e4e4;}
    .glossary-def {color: #f2eeb7; margin-bottom: 0.6em; display: block;}
    .glossary-category {color: #a0e4e4; font-weight: bold; margin-top: 1em; cursor: pointer;}
    .glossary-search {width: 90%; padding: 0.5em; margin-bottom: 1em; font-size: 1em; color: #222; background: #fff; border: none; border-radius: 5px;}
    .cultural-note {position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: #39397a; color: #fdfbdf; padding: 0.5em 1em; border-radius: 5px; box-shadow: 0 2px 8px #0002; z-index: 999; display: none; max-width: 300px; font-size: 0.9em; text-align: center;}
    @media (max-width: 700px) {#game-container {padding: 1em 0.5em;} .stats {flex-direction: column; gap: 0.4em;} .enemy-img {font-size:2em;} #score-panel {font-size: 1em;} .inv-btn {font-size:0.89em;} .answers button {font-size: 0.9em; padding: 0.5em 0.8em;}}
  </style>
</head>
<body>
<div id="game-container">
  <h2>Hong Kong English RPG Quiz</h2>
  <div id="menu">
    <p>Answer Hong Kong English questions to defeat monsters and unlock the city's secrets!<br>
    <button id="start-btn" tabindex="0">Start Game</button>
    <button id="resume-btn" style="display:none;" tabindex="0">Resume Game</button>
    <button id="glossary-btn" tabindex="0">Glossary</button>
    <button id="tutorial-btn" tabindex="0">Tutorial</button>
    <button id="stats-btn" tabindex="0">Stats</button>
    <button id="audio-toggle-btn" tabindex="0">ðŸ”Š Audio On</button>
  </div>
  <div id="game" style="display:none;">
    <button id="save-exit-btn" tabindex="0">Save & Exit</button>
    <div id="story"></div>
    <div class="progress-bar-bg"><div class="progress-bar" id="progress-bar"></div></div>
    <div id="score-panel">
      Score: <span id="score">0</span>
    </div>
    <div class="stats">
      <div>
        <strong>You</strong>
        <div class="bar"><div id="player-hp" class="bar-inner bar-player" style="width:100%"></div></div>
        <span id="player-hp-text">HP: 100</span>
        <div class="inventory" id="inventory"></div>
      </div>
      <div style="text-align:right;">
        <span class="enemy-img" id="npc-img">ðŸ‘¹</span><br>
        <strong id="npc-name">Monster</strong>
        <div class="bar"><div id="npc-hp" class="bar-inner bar-npc" style="width:100%"></div></div>
        <span id="npc-hp-text">HP: 100</span>
      </div>
    </div>
    <div class="question" id="question"></div>
    <div class="answers" id="answers"></div>
    <div>
      <button id="hint-btn" tabindex="0">ðŸ’¡ Hint</button>
    </div>
    <div id="event" style="color:#FFD700;margin:1em 0;"></div>
    <div id="log"></div>
  </div>
  <div id="gameover" style="display:none;">
    <h2 id="gameover-title"></h2>
    <div id="gameover-msg"></div>
    <button id="restart-btn" tabindex="0">Restart Game</button>
  </div>
</div>
<div id="glossary-modal"><div class="modal-content"></div></div>
<div id="tutorial-modal"><div class="modal-content"></div></div>
<div id="stats-modal"><div class="modal-content"></div></div>
<div id="confirm-modal"><div class="modal-content"></div></div>
<div id="cultural-note" class="cultural-note"></div>
<script>
